# Zero Network Panel 架构概述

本文档概述 ZNP 后端在第一阶段的主要设计目标：

1. **服务化拆分**：采用 go-zero REST 服务，后续可扩展为多服务形态。
2. **核心能力覆盖**：围绕用户、节点、订阅、套餐、监控六大域建模，对标 xboard 现有功能。
3. **可插拔基础设施**：数据库通过 GORM 支持 MySQL/PostgreSQL，缓存层提供内存/Redis 实现，后续可扩展消息队列、对象存储等组件。
4. **CI/CD 自动化**：GitHub Actions 提供静态检查与测试基线，预留 Goreleaser、Docker 镜像发布流程。
5. **协议内核扩展**：配置中定义 HTTP/gRPC 两种内核发现方式，为自研网络内核与节点服务对接提供基础能力。

## 新增能力概览

- **Kernel Discovery 注册表**：在 `ServiceContext` 中初始化 HTTP/gRPC Provider，可对接自研网络内核并通过 REST 接口触发节点配置同步。
- **订阅模板管理**：以仓储模式实现模板创建、更新、发布与历史追溯，并在用户侧提供预览与模板切换 API。
- **用户订阅视图**：组合节点与模板信息渲染示例订阅内容，输出 ETag 与内容类型，方便前端缓存与客户端消费。
- **身份认证与授权**：引入 JWT 登录与刷新机制，结合中间件对 `/admin`、`/user` 路径进行角色隔离，配合内存用户仓储模拟多角色场景。

未来迭代将基于此骨架补充真实数据库实现与协议下发逻辑。
